notifications:
  email: false

language: cpp
sudo: false

branches:
  only:
  - master

compiler:
  - clang
os:
  - linux

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - llvm-toolchain-trusty-5.0
    packages:
    - gcc-6
    - g++-6
    - clang-tidy-5.0
    - bear

install:
  - chmod +x $TRAVIS_BUILD_DIR/clean-commands.py

script:
  - cd $TRAVIS_BUILD_DIR/binutils-gdb
  - ./configure --target=mipsel-unknown-linux-gnu --prefix=$TRAVIS_BUILD_DIR/binutils-gdb/cross/mips --with-system-zlib
  - bear make MAKEINFO=true > /dev/null
  - run-clang-tidy-5.0.py -clang-tidy-binary clang-tidy-5.0 -header-filter='.*' ^.*simulator((?!conftest).)*$ | grep -v "header-filter" --color=never
  - make install > /dev/null
