notifications:
  email: false

language: cpp
sudo: false

branches:
  only:
  - master

compiler:
  - clang
os:
  - linux

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - llvm-toolchain-trusty-5.0		
    packages:
    - gcc-6
    - g++-6
    - clang-5.0
    - clang-tidy-5.0
    - llvm-5.0-dev
    - texinfo
    - zlib1g-dev
    - bear

install:
  - chmod +x $TRAVIS_BUILD_DIR/clean-commands.py

script:
  - cd $TRAVIS_BUILD_DIR/binutils-gdb
  - ./configure --target=mipsel-unknown-linux-gnu --prefix=$TRAVIS_BUILD_DIR/binutils-gdb/cross/mips --with-system-zlibheader-filter
  - bear make > /dev/null
  - $TRAVIS_BUILD_DIR/clean-commands.py
  - run-clang-tidy-5.0.py -clang-tidy-binary clang-tidy-5.0 -header-filter='.*' -checks='*,-llvm-header-guard,-readability-named-parameter,-google-readability-braces-around-statements,-llvm-include-order,-readability-braces-around-statements,-misc-macro-parentheses,-readability-inconsistent-declaration-parameter-name,-readability-avoid-const-params-in-decls,-readability-redundant-declaration,-google-readability-casting,-readability-else-after-return,-google-readability-function-size,-clang-diagnostic-extended-offsetof,-clang-analyzer-security.insecureAPI.strcpy,-readability-non-const-parameter,-android-cloexec-open,-android-cloexec-fopen,-cppcoreguidelines-pro-bounds-pointer-arithmetic,-cppcoreguidelines-pro-type-cstyle-cast,-modernize-redundant-void-arg,-modernize-use-nullptr,-cppcoreguidelines-special-member-functions,-cppcoreguidelines-pro-bounds-array-to-pointer-decay,-google-runtime-int,-modernize-use-using,-hicpp-member-init,-hicpp-special-member-functions,-cppcoreguidelines-pro-type-vararg,-google-runtime-references,-llvm-namespace-comment,-cppcoreguidelines-pro-type-union-access,-cppcoreguidelines-no-malloc,-readability-implicit-bool-cast,-modernize-deprecated-headers,-readability-misleading-indentation,-google-readability-namespace-comments,-misc-unused-parameters,-cppcoreguidelines-pro-type-reinterpret-cast' | grep -v "header-filter" --color=never
  - make install > /dev/null
